---
title: 'Part 6: For Loops and Batch Processing'
author: "Ted Laderas"
date: "11/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Learning Objectives

- **Learn** and **utilize** lists in R
- **Process** elements of a list one at a time using for loops
- **Use** metadata files to automate a process
- **Write** functions that can be applied to elements of a list

## Don't Repeat Yourself (DRY)

If you do something in R once and have to do it again, it's probably best to think of how to do it well once.

For example, say that you have multiple files that have the same format. 

Part of doing this is by using and writing *functions*.


## Lists and Vectors

```{r}
files_to_load <- list.files(path="data/",full.names = TRUE)
files_to_load
```

```{r}
load_files <- function(path){
  readxl::read_excel(path)
}

load_files(files_to_load[1])
```

## purrr::map()


```{r}
file_list <- purrr::map(files_to_load, load_files)
file_list2 <- purrr::map(file_list, janitor::clean_names)
```

## purrr::reduce()

```{r}
bound_file <- purrr::reduce(file_list2, dplyr::bind_rows)

dim(bound_file)
```


### Your Turn

Use `purrr::reduce` to find the total number of rows in all three files using `nrow()`

> Hint: You can use `sum()`

```{r}

file_rows <- purrr::map(file_list2, nrow)
purrr::reduce(file_rows, sum)

```