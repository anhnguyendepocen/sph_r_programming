---
title: 'Introduction to R, Week 1: Functions and objects'
output: github_document
---

<!--week1.md is generated from week1.Rmd. Please edit that file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Objectives

Welcome to Introduction to R from fredhutch.io!
This course introduces you R by working through common tasks in data science:
importing, manipulating, and visualizing data. 

R is a statistical and programming computer language widely used for a variety of applications.
For more information about R and ways to use it at Fred Hutch, 
please see the [R and RStudio](https://sciwiki.fredhutch.org/scicomputing/software_R/) 
entry for the Fred Hutch Biomedical Data Science Wiki.

Before proceeding with these training materials,
please ensure you have installed both R and RStudio as described [here](http://www.fredhutch.io/software/#r-and-rstudio).

By the end of this week's session, you should be able to:

- work within the RStudio interface to run and save R code in a project
- understand basic R syntax to use functions and assign objects
- create and manipulate vectors and understand how R deals with missing data 

## A brief orientation to RStudio 

[R](https://cran.r-project.org) is a statistical programming language,
while [RStudio](https://rstudio.com) is an integrated development environment (IDE) 
that allows you to code in R more easily.
RStudio possesses many features that you may find useful in your work.
We'll highlight a few of the most common and useful parts for our introductory course.

The first time you open RStudio, 
you'll see three panels, or windows.

1. The panel on the left is the console, 
where you can run R code.
The text printed in this panel is basic information about R and the version you're running. 
You can test how the console can be used to run code by entering `3 + 4` and then pressing enter.
This instructs your computer to read, interpret, and execute the command, 
then print the result (`7`) to the screen,
and show a right facing arrow (`>`), 
indicating it is ready to accept additional code.
2. The panel on the top right is the environment. 
It's empty right now, but we'll learn more about this later in this lesson.
3. The panel on the lower right shows the files present in your working directory. 
Currently, that's probably your `Home` directory, 
which includes folders like `Documents` and `Downloads`.

You may notice that some of the panels possess additional tabs.
We'll explore some of these features in this class,
but for more information:

`Help -> Cheetsheets -> RStudio IDE cheat sheet`

This PDF includes an overview of each of the things you see in RStudio,
as well as explanations of how you can use them.
It may be intimidating right now, 
but will come in handy as you gain experience with R.

One of the ways that RStudio makes working in R easier is by allowing you to create R projects. 
You can think of a project as a discrete unit of work,
such as a chapter of a thesis/dissertation,
analysis for a manuscript, 
or a monthly report. 
We recommend organizing your code, data, and other associated files as projects,
which allows you to keep all parts of an analysis together for easier access.

We'll be creating a project to use for the duration of this course. 
Create a new project in RStudio:

- `File -> New Project`
- Choose `New Directory`, then `New Project`
- name your project `intro_r` and save it somewhere on your computer you'll be able to find easily later (we recommend your Desktop or Documents)
- Click `Create project`

After your RStudio screen reloads, 
note two things:

- The file browser in the lower right panel will now show the contents of a new folder, 
`intro_r`, that was created as a part of your RStudio project. 
- The console window will show the path, or location in your computer,
for your project directory. 
This is important later in class,
when this path will be required to locate data for analysis.

Now we're ready to create a new R script:

- `File -> New File -> R Script`
- Save the new file as `week1.R`. 
By default, RStudio will save this in your project directory.

This R script is a text file that we'll use to save code we learn in this class.
We'll refer to this window as the script or source window.

By convention, 
a script should include a title at the top,
so type the following on the first line:

` # Introduction to R: Week 1`

## Using functions

Now that we have a project and new script set up, we're ready to begin adding code.
Skipping a line after the title, 
type the following on the next two lines:

```{r}
# basic math
4 + 5 
```

The first line in that example is a code comment.
It is not interpreted by R, 
but is a human-readable explanation of the code that follows. 
This is also how we included a title in our script.
In R, 
anything to the right of one or more `#` symbols represents a comment.

The code above is the same mathematical operation we executed earlier.
If we wanted to re-run this command, we have two options:

1. Copy and paste the code into the Console
2. Use the `Run` button at the top of the script window
3. Use the keyboard shortcut: `Ctrl + Enter`

The third option is the most efficient, 
especially as your coding skills progress.
With your cursor on the line with `4 + 5`, 
hold down the `Control` key and press `Enter`.
You'll see the code and answer both appear in the Console.
A few things to note about this keyboard shortcut:

- It doesn't matter where your cursor is on the line of code;
the entire line will be executed with the keyboard shortcut.
- If there isn't code on the line where your cursor is located,
RStudio will attempt to execute following lines. 

In practice, a script should represent code you are developing in R,
and you should only save the code that you know functions.
For this class, we'll be including notes about things we learn as comments.

> `Ctrl + Enter` is the only keyboard shortcut we emphasize in this course, 
> but there are many others available. 
> You can view them on the second page of the cheat sheet linked above,
> or by going to `Help -> Keyboard Shortcuts Help`.

If you were looking carefully, 
you may have noticed that the `+` in the previous code example had spaces on either side, separating it from the numbers. 
You may wonder whether spaces matter in how the code is interpreted. 
As with many questions in coding, 
the easiest way to assess whether removing the spaces matters is to simply try it:

```{r}
# same thing without spaces!
4+5
```

Given the output, 
we can conclude that spaces do not matter in how the code functions.
In this case, however,
spaces represent a common convention in formatting R code,
as it makes it easier for human eyes to read.
In general, 
you should attempt to replicate the code presented here as closely as possible,
and we'll do our best to note when something is required as opposed to convention.

> Code convention and style doesn't make or break the ability of your code to run,
> but it does affect whether other people can easily understand your code. 
> A brief overview of common code style is available [here](http://adv-r.had.co.nz/Style.html),
> and more information is available in the [tidyverse style guide](https://style.tidyverse.org).

So far, we've used R with mathematical symbols representing operations. 
R possesses the ability to perform much more complex tasks using functions,
which is a pre-defined set of code that allows you to repeat particular actions.

R includes functions for other types of math:

```{r}
# using a function: rounding numbers
round(3.14)
```

In this case,
`round` is the function, 
and `3.14` is the number (data) being manipulated by the funcion.
A word followed by parentheses is a common format for functions in R.

> Syntax refers to the rules that dictate how combinations of words and symbols are interpreted in a language (either programming or human).

Additional options for modifying functions are called arguments,
and are included with the data between parentheses.
For the `round` function, 
a common modification would be the number of decimal points output. 
You can change this detail by adding a comma and then additional argument:

```{r}
# using a function with more arguments
round(3.14, digits = 1)
```

If you would like to learn more about how this function works, 
you can go to the bottom righthand panel and click on the `Help` tab.
Enter the name of a function into the search box and hit `Enter`.
Alternatively, execute the following in your console:

`?round`

This is a shortcut for performing the same task in the panel described above.

R help documentation tends to be formatted very consistently. 
At the very top, you'll see the name of the function.
Below that, 
a short title indicates the purpose of the function, 
along with a more verbose "Description". 
"Usage" tells you how to use the function in code, 
and "Arguments" details each of the optiond in "Usage".
The rest of the subheadings should be self-explanatory.

In the example above, there is no label associated with `3.14`.
In reality, `3.14` represents `x`, 
so the command can actually be written as `round(x = 3.14, digits = 1)`.
Even if not explicitly stated,
the computer assumes that `3.14` represents `x` if the number is the first thing that appears after the opening parenthesis. 

If you define both arguments explicitly, you can switch the order in which they appear: 

```{r}
# can switch order of arguments
round(digits = 1, x = 3.14)
```

If you remove the labels (`round(1, 3.14)`), 
the answer is different, 
because R is assuming you mean `round(x = 1, digits = 3.14)`.

> You may notice that boxes pop up as you type. 
> These represent RStudio's attempts to guess what you're typing and share additional options.

**Challenge:** what does the function `hist` do? What are its main arguments? How did you determine this?

## Assigning objects

```{r}
# assigning value to an object
weight_kg <- 55 # <- is an assignment operator
# recall object
weight_kg
```

```{r}
# perform an operation on an object
2.2 * weight_kg
```

```{r}
# assign a new value to object
weight_kg <- 57.5
```

```{r}
# create new object from operation
weight_lb <- 2.2 * weight_kg
```

```{r}
weight_kg <- 100
```

The order in which operations are executed matters!

```{r}
# remove object
remove(weight_kg) # can also abbreviate to rm
```

**Challenge:** what is the value of each item at each step?
```{r}
mass <- 47.5            # mass?
width  <- 122             # width?
mass <- mass * 2.0      # mass?
width  <- width - 20        # width?
mass_index <- mass/width  # mass_index?
```

## Vectors

```{r}
# assign vector
ages <- c(50, 55, 60, 65) # c for combine/concatenate
# recall vector
ages
```


```{r}
# how many things are in object?
length(ages)
# what type of object?
class(ages)
# get overview of object
str(ages)
```


```{r}
# performing functions with vectors
mean(ages)
range(ages)
```


```{r}
# vector of characters
organs <- c("lung", "prostate", "breast")

```

**Challenge:**

- How many things are in organs?
- what type of data is organs?
- get overview of organs

Data types in R

- "character" for strings, uses quotes
-  "numeric" (or "double")
-  "integer" for integer numbers (e.g., 2L, the L indicates to R that it’s an integer)
- "logical" for TRUE and FALSE (the boolean data type)
- "complex" to represent complex numbers with real and imaginary parts (e.g., 1 + 4i)
- "raw" for bitstreams

**Challenge:** what happens when each of the objects are created?

```{r}
num_char <- c(1, 2, 3, "a")
num_logical <- c(1, 2, 3, TRUE)
char_logical <- c("a", "b", "c", TRUE)
tricky <- c(1, 2, 3, "4")
```

## Working with vectors

```{r}
# add a value at the end of vector
ages <- c(ages, 90) # same combine function as creating vector
```

```{r}
# add value at the beginning
ages <- c(30, ages)
```

```{r}
# subsetting vectors (index starts at 1)
organs[2] # extracting single value
```


```{r}
organs[c(1, 3)] # extracting multiple values
```

```{r}
organs[-2] # excluding values
```

```{r}
# conditional subsetting
ages > 60 # identifies whether each part of vector meets condition
```

```{r}
ages[ages > 60] # extracts values which meet condition
```

```{r}
ages[ages == 60]
```

Can also include <= and >=

```{r}
# combining conditions: OR
ages[ages < 50 | ages > 60]
```

# can also combine condition with AND &, but be careful about vernacular
# OR means value must meet one or more conditions
# AND means value must meet both conditions

```{r}
ages[ages < 50 & ages > 60] # not possible!

```

**Challenge:** why does the following code return TRUE: 
```{r}
"four" > "five"
```

## Missing data

```{r}
# create new vector with missing data indicated by NA
heights <- c(2, 4, 4, NA, 6)
```

```{r}
# perform function on vector
mean(heights) # what is wrong with this answer?
max(heights)
```

```{r}
# add argument to remove NA
mean(heights, na.rm = TRUE)
max(heights, na.rm = TRUE)
```

Additional ways to remove missing data

```{r}
# identify elements which are missing data
is.na(heights)
```

```{r}
# reverse the TRUE/FALSE
!is.na(heights)
```

```{r}
# extract elements which are not missing values
heights[!is.na(heights)]
```

```{r}
# remove incomplete cases
na.omit(heights) # what is different about this result?
```

**Challenge:**
```{r}
# create vector
more_heights <- c(63, 69, 60, 65, NA, 68, 61, 70, 61, 59, 64, 69, 63, 63, NA, 72, 65, 64, 70, 63, 65)
```

- remove NAs from `more_heights`
- calculate median
- identify how many elements from more_heights are greater than 67 inches
- visualize data as a histogram (hint: function `hist`)

## Wrapping up

- review objectives
- direct towards practice questions (linked in HackMD)
- preview next week's objectives
- closing RStudio projects:
-   don't save .RData
-   can change in Global Options

## Errata

**If you need to reopen your project after closing RStudio,**
you should use the `File -> Open Project` and navigate to the location of your project directory.
Alternatively, using your operating system's file browser,
double click on the `r_intro.Rrpoj` file.

**If you would like more practice,** 
the [`exercises`](exercises/) directory contains additional tasks for practice.
Answers to those and in-class questions are available in the [`solutions`](solutions/) directory. 

**This document is written in [R markdown](http://rmarkdown.rstudio.com),**
which is a method of formatting text, code, and output to create documents that are sharable with other people. 
While this document is intended to serve as a reference for you to read while typing code into your own script,
you may also be interested in modifying and running code in the original R markdown file ([`week4.Rmd`](week4.Rmd) in the GitHub repository).
